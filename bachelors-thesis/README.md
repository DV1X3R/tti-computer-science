# Development of a Platform for Multiparticipant Chat Analysis	
# Grupas tērzēšanas analīzes platformas izstrāde  
# Разработка платформы для анализа групповых чатов  

Инструмент для мониторинга и анализа текстовых сообщений
* Целевая аудитория: Администраторы групповых чатов  
  
* Источник данных: Discord Messenger
* Анализ чата: динамика сообщений
* Анализ текстов: семантика, эмоциональная окраска
  * Google Natural Language API: https://cloud.google.com/natural-language/
  * Google Perspective API: https://www.perspectiveapi.com/
  
Цель: Разработка платформы для анализа групповых чатов, предоставляющей пользователям статистику и информацию о сообщениях.  
  
Задачи  
1. Экспорт сообщений из группового чата  
2. Загрузка и хранение сообщений в базе данных  
3. Разработка модуля для анализа текстов сообщений  
4. Разработка клиент-части для отображения полученной информации  


Business Model
```
Платформа представляет собой инструмент для мониторинга статистики и анализа сообщений в чат-комнатах мессенджеров. Сообщения загружаются в базу данных платформы, после чего приложение производит их анализ и агрегацию.
a) Определение, является ли сообщение информативным: Не должно состоять только из ссылки, специальных символов, шумовых слов (стоп-слов) или вложений.
b) Анализ сообщения через Google API для семантического анализа текста (смысловое значение единиц языка) и определения эмоциональной окраски. На момент разработки данный API поддерживает только английский язык. Для анализа сообщений на других языках, сообщения будут предварительно переводиться на английский язык при помощи Yandex Translate API.
Статистика и результаты анализа будут доступны на веб-странице платформы.

```

Предоставляемая статистика и информация
```
Атрибуты: Источник данных, Пользователь, Время (Час)
    Метрики: Количество сообщений, Количество слов, Количество ссылок, Количество вложений, Оставленные реакции (Reactions) и их количество.
    Доп.Информация: Google API - Категоризация, Эмоциональная окраска

Данную статистику можно будет получить за выбранный пользователем системы промежуток времени.

Применение:
    Определить, в какое время года / месяц / день недели и время суток чат-комната наиболее активна
    Выявить наиболее активных / грубых пользователей (ex. можно использовать диаграмму 'ящик с усами')
    Определить наиболее часто используемые реакции и пр.
```

Методология разработки: Итеративная разработка.
```
При выполнении данной работы будет использоваться итеративная модель разработки ПО.
В проекте могут изменяться детали реализации по мере разработки, что исключает выбор инкрементальной и каскадных моделей.
В качестве системы контроля версий будет использован Git.
```

Архитектура - трёхуровневое клиент-серверное приложение.
```
Клиент - графическое отображение статистических данных
Сервер - получение, обработка, анализ и агрегация сообщений
Сервер базы данных - хранилище сообщений для их анализа
```

Инструменты реализации  
* Node JS (TypeScript)
* MongoDB
  
Структура MongoDB документов
```
datasources { // Коллекция источников данных
    "_id": new ObjectId(),
    "extractor":
        {
            "type": String, // Способ получения сообщений (ex. "Chatbot")
            "platform": String, // Платформа источника сообщений (ex. "Discord" / "Slack")
            "identifier": String // Идентификатор интерфейса (ex. "MyBot#1234" / "Facebook API")
        },
    "sourceId": String, // ID источника (оригинальный идентификатор)
    "name": String, // Имя источника (ex. "Programming Community #1")
    "createdAt": Date, // Дата создания источника
    "iconURL": String, // Изображение источника
    "channels": [ // Массив каналов источника
        {
            "sourceId": String, // ID канала в источнике (оригинальный идентификатор)
            "name": String, // Название канала (ex. "main" / "C++" / "JavaScript")
            "type": String, // Тип канала (ex. "text" / "voice")
            "createdAt": Date // Дата создания канала
        }
    ],
    "users": [ // Массив пользователей источника
        {
            "sourceId": String, // ID пользователя в источнике (оригинальный идентификатор)
            "userName": String, // Имя пользователя (ex. "Jack#4321")
            "bot": Bool // Является ли пользователь ботом (ex. "false")
        }
    ]
}

messages { // Коллекция сообщений
    "_id": new ObjectID(),
    "dataSourceId": ObjectId("xxxx"), // _ID источника
    "channelId": String, // ID канала (оригинальный идентификатор)
    "userId": String, // ID пользователя (оригинальный идентификатор)
    "sourceId": String, // ID сообщения (оригинальный идентификатор)
    "createdAt": Date, // Дата создания сообщения
    "cleanContent": String, // Содержание сообщения (ex. "Hello @Jack! :wave:")
    "attachments": Integer, // Количество вложений
    "mentions": [ // Массив - Упоминания других пользователей
        {
            "userId": String, // ID пользователя (оригинальный идентификатор)
            "count": Integer // Количество упоминаний
        }],
    "reactions": [ // Массив - реакции на сообщение
        {
            "reaction": String, // Реакция (ex. ":smiley:")
            "userIds": [String] // Массив ID пользователей
        }
    ]
}

processed { // Коллекция агрегированных данных
    "_id": new ObjectID(),
    "dataSourceId": ObjectId("xxxx"), // _ID источника
    "channelId": String, // ID канала (оригинальный идентификатор)
    "userId": String, // ID пользователя (оригинальный идентификатор)
    "createdAtHour": Date, // Дата (Часы)
    "messages": Integer, // Количество сообщений
    "words": Integer, // Количество слов
    "attachments": Integer, // Количество вложений
    "reactions": [ // Массив реакций
        {
            "reaction": String, // Реакция
            "count": Integer // Количество
        }],
    "perspectiveApi": [Double] // Массив коэффициентов Perspective API (ex. "0.02")
}
```
