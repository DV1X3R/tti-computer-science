# Development of a Platform for Multiparticipant Chat Analysis	

* Целевая аудитория: Пользователи приложений для обмена сообщений в интернете (мессенджеров): Администраторы и модераторы групповых чатов.  

Business Model
```
Платформа представляет собой инструмент для мониторинга статистики и анализа сообщений в чат-комнатах мессенджеров.
Сообщения загружаются в базу данных платформы, после чего приложение производит их анализ и агрегацию.
В качестве дополнительного анализа будет использован Google Perspective API (Text Mining), позволяющий определять оскорбительные и грубые сообщения (эмоциональную окраску текста). https://www.perspectiveapi.com/
На момент разработки данный API поддерживает только английский язык. Для анализа сообщений на других языках, сообщения будут предварительно переводиться на английский язык при помощи Yandex Translate API. https://tech.yandex.com/translate/
Не все сообщения будут подвержены данному типу анализа - ссылки, сообщения от чат-ботов и неинформативные шумовые слова (стоп-слова) будут игнорироваться.
Статистика и результаты анализа будут доступны на веб-странице платформы.
```

Предоставляемая статистика и информация
```
Данную статистику можно будет получить за выбранный пользователем системы промежуток времени.
Агрегация данных #1:
    Атрибуты: Источник данных, Пользователь, Время (Час)
    Метрики: Количество сообщений, Количество слов, Количество ссылок, Количество вложений, Оставленные реакции (Reactions) и их количество.
    Доп.Метрики: Значение коэф. Perspective API
Применение:
    Определить, в какое время года / месяц / день недели и время суток чат-комната наиболее активна
    Выявить наиболее активных / грубых пользователей (ex. можно использовать диаграмму 'ящик с усами')
    Определить наиболее часто используемые реакции и пр.
```

Методология разработки: Итеративная разработка.
```
При выполнении данной работы будет использоваться итеративная модель разработки ПО.
В проекте могут изменяться детали реализации по мере разработки, что исключает выбор инкрементальной и каскадных моделей.
В качестве системы контроля версий будет использован Git.
```

Архитектура - трёхуровневое клиент-серверное приложение.
```
Клиент - отображение статистики и графиков
Сервер - получение, обработка и агрегация данных
Сервер базы данных - хранилище сообщений для их анализа
```

Структура MongoDB документов
```
datasources { // Коллекция источников данных
    "_id": new ObjectId(),
    "extractor":
        {
            "type": String, // Способ получения сообщений (ex. "Chatbot")
            "platform": String, // Платформа источника сообщений (ex. "Discord" / "Slack")
            "identifier": String // Идентификатор интерфейса (ex. "MyBot#1234" / "Facebook API")
        },
    "sourceId": String, // ID источника (оригинальный идентификатор)
    "name": String, // Имя источника (ex. "Programming Community #1")
    "createdAt": Date, // Дата создания источника
    "iconURL": String, // Изображение источника
    "channels": [ // Массив каналов источника
        {
            "sourceId": String, // ID канала в источнике (оригинальный идентификатор)
            "name": String, // Название канала (ex. "main" / "C++" / "JavaScript")
            "type": String, // Тип канала (ex. "text" / "voice")
            "createdAt": Date // Дата создания канала
        }
    ],
    "users": [ // Массив пользователей источника
        {
            "sourceId": String, // ID пользователя в источнике (оригинальный идентификатор)
            "userName": String, // Имя пользователя (ex. "Jack#4321")
            "bot": Bool // Является ли пользователь ботом (ex. "false")
        }
    ]
}

messages { // Коллекция сообщений
    "_id": new ObjectID(),
    "dataSourceId": ObjectId("xxxx"), // _ID источника
    "channelId": String, // ID канала (оригинальный идентификатор)
    "userId": String, // ID пользователя (оригинальный идентификатор)
    "sourceId": String, // ID сообщения (оригинальный идентификатор)
    "createdAt": Date, // Дата создания сообщения
    "cleanContent": String, // Содержание сообщения (ex. "Hello @Jack! :wave:")
    "attachments": Integer, // Количество вложений
    "mentions": [ // Массив - Упоминания других пользователей
        {
            "userId": String, // ID пользователя (оригинальный идентификатор)
            "count": Integer // Количество упоминаний
        }],
    "reactions": [ // Массив - реакции на сообщение
        {
            "reaction": String, // Реакция (ex. ":smiley:")
            "userIds": [String] // Массив ID пользователей
        }
    ]
}

processed { // Коллекция агрегированных данных
    "_id": new ObjectID(),
    "dataSourceId": ObjectId("xxxx"), // _ID источника
    "channelId": String, // ID канала (оригинальный идентификатор)
    "userId": String, // ID пользователя (оригинальный идентификатор)
    "createdAtHour": Date, // Дата (Часы)
    "messages": Integer, // Количество сообщений
    "words": Integer, // Количество слов
    "attachments": Integer, // Количество вложений
    "reactions": [ // Массив реакций
        {
            "reaction": String, // Реакция
            "count": Integer // Количество
        }],
    "perspectiveApi": [Double] // Массив коэффициентов Perspective API (ex. "0.02")
}
```
